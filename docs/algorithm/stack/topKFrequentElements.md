---
title: 02.å‰ K ä¸ªé«˜é¢‘å…ƒç´ 
toc: content
# nav:
#   title: ç®—æ³•
# group:
#   title: æ ˆä¸é˜Ÿåˆ—
#   order: 2
---

# 02.å‰ K ä¸ªé«˜é¢‘å…ƒç´ 
### é¢˜ç›®éš¾åº¦ï¼šğŸ”¥ğŸ”¥ ä¸­ç­‰
ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªæ•´æ•° k ï¼Œè¯·ä½ è¿”å›å…¶ä¸­å‡ºç°é¢‘ç‡å‰ k é«˜çš„å…ƒç´ ã€‚ä½ å¯ä»¥æŒ‰ ä»»æ„é¡ºåº è¿”å›ç­”æ¡ˆã€‚


#### ç¤ºä¾‹ 1:
```bash
è¾“å…¥: nums = [1,1,1,2,2,3], k = 2
è¾“å‡º: [1,2]
```
#### ç¤ºä¾‹ 2:

```bash
è¾“å…¥: nums = [1], k = 1
è¾“å‡º: [1]
 ```

#### æç¤ºï¼š

- 1 <= nums.length <= 105
- k çš„å–å€¼èŒƒå›´æ˜¯ [1, æ•°ç»„ä¸­ä¸ç›¸åŒçš„å…ƒç´ çš„ä¸ªæ•°]
- é¢˜ç›®æ•°æ®ä¿è¯ç­”æ¡ˆå”¯ä¸€ï¼Œæ¢å¥è¯è¯´ï¼Œæ•°ç»„ä¸­å‰ k ä¸ªé«˜é¢‘å…ƒç´ çš„é›†åˆæ˜¯å”¯ä¸€çš„


#### è¿›é˜¶ï¼š
ä½ æ‰€è®¾è®¡ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ å¿…é¡» ä¼˜äº O(n log n) ï¼Œå…¶ä¸­ n æ˜¯æ•°ç»„å¤§å°ã€‚

#### è§£é¢˜æ€è·¯
è¿™é“é¢˜ç›®ä¸»è¦æ¶‰åŠåˆ°å¦‚ä¸‹ä¸‰å—å†…å®¹ï¼š

- è¦ç»Ÿè®¡å…ƒç´ å‡ºç°é¢‘ç‡
- å¯¹é¢‘ç‡æ’åº
- æ‰¾å‡ºå‰Kä¸ªé«˜é¢‘å…ƒç´ 
é¦–å…ˆç»Ÿè®¡å…ƒç´ å‡ºç°çš„é¢‘ç‡ï¼Œè¿™ä¸€ç±»çš„é—®é¢˜å¯ä»¥ä½¿ç”¨mapæ¥è¿›è¡Œç»Ÿè®¡ã€‚

ç„¶åæ˜¯å¯¹é¢‘ç‡è¿›è¡Œæ’åºï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ç§ å®¹å™¨é€‚é…å™¨å°±æ˜¯ä¼˜å…ˆçº§é˜Ÿåˆ—
ç„¶åæ˜¯å¯¹é¢‘ç‡è¿›è¡Œæ’åºï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ç§ å®¹å™¨é€‚é…å™¨å°±æ˜¯ä¼˜å…ˆçº§é˜Ÿåˆ—ã€‚

ä»€ä¹ˆæ˜¯ä¼˜å…ˆçº§é˜Ÿåˆ—å‘¢ï¼Ÿ

å…¶å®å°±æ˜¯ä¸€ä¸ªæŠ«ç€é˜Ÿåˆ—å¤–è¡£çš„å †ï¼Œå› ä¸ºä¼˜å…ˆçº§é˜Ÿåˆ—å¯¹å¤–æ¥å£åªæ˜¯ä»é˜Ÿå¤´å–å…ƒç´ ï¼Œä»é˜Ÿå°¾æ·»åŠ å…ƒç´ ï¼Œå†æ— å…¶ä»–å–å…ƒç´ çš„æ–¹å¼ï¼Œçœ‹èµ·æ¥å°±æ˜¯ä¸€ä¸ªé˜Ÿåˆ—ã€‚
è€Œä¸”ä¼˜å…ˆçº§é˜Ÿåˆ—å†…éƒ¨å…ƒç´ æ˜¯è‡ªåŠ¨ä¾ç…§å…ƒç´ çš„æƒå€¼æ’åˆ—ã€‚é‚£ä¹ˆå®ƒæ˜¯å¦‚ä½•æœ‰åºæ’åˆ—çš„å‘¢ï¼Ÿ

ç¼ºçœæƒ…å†µä¸‹priority_queueåˆ©ç”¨max-heapï¼ˆå¤§é¡¶å †ï¼‰å®Œæˆå¯¹å…ƒç´ çš„æ’åºï¼Œè¿™ä¸ªå¤§é¡¶å †æ˜¯ä»¥vectorä¸ºè¡¨ç°å½¢å¼çš„complete binary treeï¼ˆå®Œå…¨äºŒå‰æ ‘ï¼‰ã€‚

ä»€ä¹ˆæ˜¯å †å‘¢ï¼Ÿ

å †æ˜¯ä¸€æ£µå®Œå…¨äºŒå‰æ ‘ï¼Œæ ‘ä¸­æ¯ä¸ªç»“ç‚¹çš„å€¼éƒ½ä¸å°äºï¼ˆæˆ–ä¸å¤§äºï¼‰å…¶å·¦å³å­©å­çš„å€¼ã€‚ å¦‚æœçˆ¶äº²ç»“ç‚¹æ˜¯å¤§äºç­‰äºå·¦å³å­©å­å°±æ˜¯å¤§é¡¶å †ï¼Œå°äºç­‰äºå·¦å³å­©å­å°±æ˜¯å°é¡¶å †ã€‚

æ‰€ä»¥å¤§å®¶ç»å¸¸è¯´çš„å¤§é¡¶å †ï¼ˆå †å¤´æ˜¯æœ€å¤§å…ƒç´ ï¼‰ï¼Œå°é¡¶å †ï¼ˆå †å¤´æ˜¯æœ€å°å…ƒç´ ï¼‰ï¼Œå¦‚æœæ‡’å¾—è‡ªå·±å®ç°çš„è¯ï¼Œå°±ç›´æ¥ç”¨priority_queueï¼ˆä¼˜å…ˆçº§é˜Ÿåˆ—ï¼‰å°±å¯ä»¥äº†ï¼Œåº•å±‚å®ç°éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä»å°åˆ°å¤§æ’å°±æ˜¯å°é¡¶å †ï¼Œä»å¤§åˆ°å°æ’å°±æ˜¯å¤§é¡¶å †ã€‚

æœ¬é¢˜æˆ‘ä»¬å°±è¦ä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—æ¥å¯¹éƒ¨åˆ†é¢‘ç‡è¿›è¡Œæ’åºã€‚

ä¸ºä»€ä¹ˆä¸ç”¨å¿«æ’å‘¢ï¼Œ ä½¿ç”¨å¿«æ’è¦å°†mapè½¬æ¢ä¸ºvectorçš„ç»“æ„ï¼Œç„¶åå¯¹æ•´ä¸ªæ•°ç»„è¿›è¡Œæ’åºï¼Œ è€Œè¿™ç§åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬å…¶å®åªéœ€è¦ç»´æŠ¤kä¸ªæœ‰åºçš„åºåˆ—å°±å¯ä»¥äº†ï¼Œæ‰€ä»¥ä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—æ˜¯æœ€ä¼˜çš„ã€‚

æ­¤æ—¶è¦æ€è€ƒä¸€ä¸‹ï¼Œæ˜¯ä½¿ç”¨å°é¡¶å †å‘¢ï¼Œè¿˜æ˜¯å¤§é¡¶å †ï¼Ÿ

æœ‰çš„åŒå­¦ä¸€æƒ³ï¼Œé¢˜ç›®è¦æ±‚å‰ K ä¸ªé«˜é¢‘å…ƒç´ ï¼Œé‚£ä¹ˆæœæ–­ç”¨å¤§é¡¶å †å•Šã€‚

é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå®šä¹‰ä¸€ä¸ªå¤§å°ä¸ºkçš„å¤§é¡¶å †ï¼Œåœ¨æ¯æ¬¡ç§»åŠ¨æ›´æ–°å¤§é¡¶å †çš„æ—¶å€™ï¼Œæ¯æ¬¡å¼¹å‡ºéƒ½æŠŠæœ€å¤§çš„å…ƒç´ å¼¹å‡ºå»äº†ï¼Œé‚£ä¹ˆæ€ä¹ˆä¿ç•™ä¸‹æ¥å‰Kä¸ªé«˜é¢‘å…ƒç´ å‘¢ã€‚

è€Œä¸”ä½¿ç”¨å¤§é¡¶å †å°±è¦æŠŠæ‰€æœ‰å…ƒç´ éƒ½è¿›è¡Œæ’åºï¼Œé‚£èƒ½ä¸èƒ½åªæ’åºkä¸ªå…ƒç´ å‘¢ï¼Ÿ

**æ‰€ä»¥æˆ‘ä»¬è¦ç”¨å°é¡¶å †ï¼Œå› ä¸ºè¦ç»Ÿè®¡æœ€å¤§å‰kä¸ªå…ƒç´ ï¼Œåªæœ‰å°é¡¶å †æ¯æ¬¡å°†æœ€å°çš„å…ƒç´ å¼¹å‡ºï¼Œæœ€åå°é¡¶å †é‡Œç§¯ç´¯çš„æ‰æ˜¯å‰kä¸ªæœ€å¤§å…ƒç´ ã€‚**

## è§£æ³•
javascript
```js
// js æ²¡æœ‰å † éœ€è¦è‡ªå·±æ„é€ 
class Heap {
    constructor(compareFn) {
        this.compareFn = compareFn;
        this.queue = [];
    }

    // æ·»åŠ 
    push(item) {
        // æ¨å…¥å…ƒç´ 
        this.queue.push(item);

        // ä¸Šæµ®
        let index = this.size() - 1; // è®°å½•æ¨å…¥å…ƒç´ ä¸‹æ ‡
        let parent = Math.floor((index - 1) / 2); // è®°å½•çˆ¶èŠ‚ç‚¹ä¸‹æ ‡

        while (parent >= 0 && this.compare(parent, index) > 0) { // æ³¨æ„compareå‚æ•°é¡ºåº
            [this.queue[index], this.queue[parent]] = [this.queue[parent], this.queue[index]];

            // æ›´æ–°ä¸‹æ ‡
            index = parent;
            parent = Math.floor((index - 1) / 2);
        }
    }

    // è·å–å †é¡¶å…ƒç´ å¹¶ç§»é™¤
    pop() {
        // å †é¡¶å…ƒç´ 
        const out = this.queue[0];

        // ç§»é™¤å †é¡¶å…ƒç´  å¡«å…¥æœ€åä¸€ä¸ªå…ƒç´ 
        this.queue[0] = this.queue.pop();

        // ä¸‹æ²‰
        let index = 0; // è®°å½•ä¸‹æ²‰å…ƒç´ ä¸‹æ ‡
        let left = 1; // left æ˜¯å·¦å­èŠ‚ç‚¹ä¸‹æ ‡ left + 1 åˆ™æ˜¯å³å­èŠ‚ç‚¹ä¸‹æ ‡
        let searchChild = this.compare(left, left + 1) > 0 ? left + 1 : left;

        while (searchChild !== undefined && this.compare(index, searchChild) > 0) { // æ³¨æ„compareå‚æ•°é¡ºåº
            [this.queue[index], this.queue[searchChild]] = [this.queue[searchChild], this.queue[index]];

            // æ›´æ–°ä¸‹æ ‡
            index = searchChild;
            left = 2 * index + 1;
            searchChild = this.compare(left, left + 1) > 0 ? left + 1 : left;
        }

        return out;
    }

    size() {
        return this.queue.length;
    }

    // ä½¿ç”¨ä¼ å…¥çš„ compareFn æ¯”è¾ƒä¸¤ä¸ªä½ç½®çš„å…ƒç´ 
    compare(index1, index2) {
        // å¤„ç†ä¸‹æ ‡è¶Šç•Œé—®é¢˜
        if (this.queue[index1] === undefined) return 1;
        if (this.queue[index2] === undefined) return -1;

        return this.compareFn(this.queue[index1], this.queue[index2]);
    }

}

const topKFrequent = function (nums, k) {
    const map = new Map();

    for (const num of nums) {
        map.set(num, (map.get(num) || 0) + 1);
    }

    // åˆ›å»ºå°é¡¶å †
    const heap= new Heap((a, b) => a[1] - b[1]);

    // entry æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º2çš„æ•°ç»„ï¼Œ0ä½ç½®å­˜å‚¨keyï¼Œ1ä½ç½®å­˜å‚¨value
    for (const entry of map.entries()) {
        heap.push(entry);

        if (heap.size() > k) {
            heap.pop();
        }
    }

    // return heap.queue.map(e => e[0]);

    const res = [];

    for (let i = heap.size() - 1; i >= 0; i--) {
        res[i] = heap.pop()[0];
    }

    return res;
};
```


typescript
```ts
function topKFrequent(nums: number[], k: number): number[] {
    const countMap:Map<number,number> = new Map()
    for(let num of nums){
        countMap.set(num,(countMap.get(num)||0)+1)
    }
    return [...countMap.entries()].sort((a,b)=>b[1]-a[1]).slice(0,k).map(i=>i[0])
};

```
